{"ast":null,"code":"var _jsxFileName = \"D:\\\\repos\\\\saalla-next.js\\\\components\\\\LinkPreview\\\\index.jsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport cheerio from \"cheerio\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Card from \"@material-ui/core/Card\";\nimport CardActionArea from \"@material-ui/core/CardActionArea\";\nimport Skeleton from \"@material-ui/lab/Skeleton\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport CardMedia from \"@material-ui/core/CardMedia\";\nimport Typography from \"@material-ui/core/Typography\";\nvar useStyles = makeStyles({\n  rootLink: {\n    width: \"100%\",\n    boxShadow: \"0px 2px 1px -1px rgba(0,0,0,0.2), 0px 1px 1px 0px rgba(0,0,0,0.14), 0px 1px 3px 0px rgba(0,0,0,0.12) !important\"\n  },\n  media: {\n    height: 0,\n    paddingTop: \"56.25%\" // 16:9\n\n  },\n  title: {\n    fontSize: \"1rem !important\"\n  },\n  description: {\n    marginRight: \"0px !important\",\n    marginLeft: \"0px !important\"\n  }\n});\nvar CORS_PROXY = \"https://tranquil-crag-40722.herokuapp.com/\";\n\nvar getPreviewData = function getPreviewData(tags) {\n  var result = tags.reduce(function (previewData, item) {\n    switch (item.tag) {\n      case \"og:title\":\n        previewData.title = item.value;\n        break;\n\n      case \"og:url\":\n        previewData.link = item.value;\n        break;\n\n      case \"og:description\":\n        previewData.description = item.value;\n        break;\n\n      case \"og:site_name\":\n        previewData.site = item.value;\n        break;\n\n      case \"og:image\":\n        previewData.image = item.value;\n        break;\n\n      default:\n        break;\n    }\n\n    return previewData;\n  }, {});\n  return Promise.resolve(result);\n};\n\nvar parseHTML = function parseHTML(html) {\n  var $ = cheerio.load(html);\n  var meta = [];\n  $(\"head meta\").map(function (i, item) {\n    if (!item.attribs) return null;\n    var property = item.attribs.property || null;\n    var content = item.attribs.content || null;\n    if (!property || !content) return null;\n    meta.push({\n      tag: property,\n      value: content\n    });\n    return null;\n  });\n  return Promise.resolve(meta);\n};\n\nvar fetchUrl = function fetchUrl(url) {\n  return axios(CORS_PROXY + url).then(function (response) {\n    return response.data;\n  });\n};\n\nvar getUrl = function getUrl(text) {\n  if (!text) return null;\n  var a = document.createElement(\"a\");\n  a.href = text;\n  var protocol = a.protocol,\n      host = a.host,\n      pathname = a.pathname,\n      search = a.search,\n      hash = a.hash;\n  var url = \"\".concat(protocol, \"//\").concat(host).concat(pathname).concat(search).concat(hash);\n  var isSameHost = host === window.location.host;\n  if (isSameHost) return null;\n  return url;\n};\n\nexport default function LinkPreview(props) {\n  _s();\n\n  var _useState = useState(null),\n      previewData = _useState[0],\n      setPreviewData = _useState[1];\n\n  var classes = useStyles();\n  useEffect(function () {\n    fetchUrl(props.url).then(parseHTML).then(getPreviewData).then(setPreviewData);\n  }, []);\n  return __jsx(Card, {\n    className: classes.rootLink,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 5\n    }\n  }, __jsx(\"a\", {\n    href: previewData && previewData.link,\n    target: \"_blank\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }\n  }, __jsx(CardActionArea, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 9\n    }\n  }, !previewData ? __jsx(Skeleton, {\n    animation: \"wave\",\n    variant: \"rect\",\n    className: classes.media,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 13\n    }\n  }) : __jsx(CardMedia, {\n    className: classes.media,\n    image: previewData.image,\n    title: previewData.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 13\n    }\n  }), __jsx(CardContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 11\n    }\n  }, __jsx(Typography, {\n    className: classes.title,\n    gutterBottom: true,\n    variant: \"h5\",\n    component: \"h2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 13\n    }\n  }, previewData && previewData.site), __jsx(Typography, {\n    className: classes.title,\n    gutterBottom: true,\n    variant: \"h5\",\n    component: \"h2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }\n  }, previewData && previewData.title), !previewData ? __jsx(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 15\n    }\n  }, __jsx(Skeleton, {\n    animation: \"wave\",\n    height: 10,\n    style: {\n      marginBottom: 6\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 17\n    }\n  }), __jsx(Skeleton, {\n    animation: \"wave\",\n    height: 10,\n    width: \"80%\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 17\n    }\n  })) : __jsx(Typography, {\n    className: classes.description,\n    variant: \"body2\",\n    color: \"textSecondary\",\n    component: \"p\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 15\n    }\n  }, previewData.description)))));\n}\n\n_s(LinkPreview, \"b6IXUyvaKSIgvjgZvVu6oY3+biQ=\", false, function () {\n  return [useStyles];\n});\n\n_c = LinkPreview;\n\nvar _c;\n\n$RefreshReg$(_c, \"LinkPreview\");","map":{"version":3,"sources":["D:/repos/saalla-next.js/components/LinkPreview/index.jsx"],"names":["React","useState","useEffect","axios","cheerio","makeStyles","Card","CardActionArea","Skeleton","CardContent","CardMedia","Typography","useStyles","rootLink","width","boxShadow","media","height","paddingTop","title","fontSize","description","marginRight","marginLeft","CORS_PROXY","getPreviewData","tags","result","reduce","previewData","item","tag","value","link","site","image","Promise","resolve","parseHTML","html","$","load","meta","map","i","attribs","property","content","push","fetchUrl","url","then","response","data","getUrl","text","a","document","createElement","href","protocol","host","pathname","search","hash","isSameHost","window","location","LinkPreview","props","setPreviewData","classes","marginBottom"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport cheerio from \"cheerio\";\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardActionArea from \"@material-ui/core/CardActionArea\";\r\nimport Skeleton from \"@material-ui/lab/Skeleton\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport CardMedia from \"@material-ui/core/CardMedia\";\r\nimport Typography from \"@material-ui/core/Typography\";\r\n\r\nconst useStyles = makeStyles({\r\n  rootLink: {\r\n    width: \"100%\",\r\n    boxShadow:\r\n      \"0px 2px 1px -1px rgba(0,0,0,0.2), 0px 1px 1px 0px rgba(0,0,0,0.14), 0px 1px 3px 0px rgba(0,0,0,0.12) !important\",\r\n  },\r\n  media: {\r\n    height: 0,\r\n    paddingTop: \"56.25%\", // 16:9\r\n  },\r\n  title: {\r\n    fontSize: \"1rem !important\",\r\n  },\r\n  description: {\r\n    marginRight: \"0px !important\",\r\n    marginLeft: \"0px !important\",\r\n  },\r\n});\r\n\r\nconst CORS_PROXY = \"https://tranquil-crag-40722.herokuapp.com/\";\r\n\r\nconst getPreviewData = (tags) => {\r\n  const result = tags.reduce((previewData, item) => {\r\n    switch (item.tag) {\r\n      case \"og:title\":\r\n        previewData.title = item.value;\r\n        break;\r\n      case \"og:url\":\r\n        previewData.link = item.value;\r\n        break;\r\n      case \"og:description\":\r\n        previewData.description = item.value;\r\n        break;\r\n      case \"og:site_name\":\r\n        previewData.site = item.value;\r\n        break;\r\n      case \"og:image\":\r\n        previewData.image = item.value;\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n    return previewData;\r\n  }, {});\r\n\r\n  return Promise.resolve(result);\r\n};\r\n\r\nconst parseHTML = (html) => {\r\n  const $ = cheerio.load(html);\r\n\r\n  const meta = [];\r\n  $(\"head meta\").map((i, item) => {\r\n    if (!item.attribs) return null;\r\n\r\n    const property = item.attribs.property || null;\r\n    const content = item.attribs.content || null;\r\n\r\n    if (!property || !content) return null;\r\n\r\n    meta.push({ tag: property, value: content });\r\n    return null;\r\n  });\r\n\r\n  return Promise.resolve(meta);\r\n};\r\n\r\nconst fetchUrl = (url) => {\r\n  return axios(CORS_PROXY + url).then((response) => response.data);\r\n};\r\n\r\nconst getUrl = (text) => {\r\n  if (!text) return null;\r\n\r\n  const a = document.createElement(\"a\");\r\n  a.href = text;\r\n\r\n  const { protocol, host, pathname, search, hash } = a;\r\n\r\n  const url = `${protocol}//${host}${pathname}${search}${hash}`;\r\n\r\n  const isSameHost = host === window.location.host;\r\n\r\n  if (isSameHost) return null;\r\n\r\n  return url;\r\n};\r\n\r\nexport default function LinkPreview(props) {\r\n  const [previewData, setPreviewData] = useState(null);\r\n  const classes = useStyles();\r\n\r\n  useEffect(() => {\r\n    fetchUrl(props.url)\r\n      .then(parseHTML)\r\n      .then(getPreviewData)\r\n      .then(setPreviewData);\r\n  }, []);\r\n\r\n  return (\r\n    <Card className={classes.rootLink}>\r\n      <a href={previewData && previewData.link} target=\"_blank\">\r\n        <CardActionArea>\r\n          {!previewData ? (\r\n            <Skeleton\r\n              animation=\"wave\"\r\n              variant=\"rect\"\r\n              className={classes.media}\r\n            />\r\n          ) : (\r\n            <CardMedia\r\n              className={classes.media}\r\n              image={previewData.image}\r\n              title={previewData.title}\r\n            />\r\n          )}\r\n          <CardContent>\r\n            <Typography\r\n              className={classes.title}\r\n              gutterBottom\r\n              variant=\"h5\"\r\n              component=\"h2\"\r\n            >\r\n              {previewData && previewData.site}\r\n            </Typography>\r\n            <Typography\r\n              className={classes.title}\r\n              gutterBottom\r\n              variant=\"h5\"\r\n              component=\"h2\"\r\n            >\r\n              {previewData && previewData.title}\r\n            </Typography>\r\n            {!previewData ? (\r\n              <React.Fragment>\r\n                <Skeleton\r\n                  animation=\"wave\"\r\n                  height={10}\r\n                  style={{ marginBottom: 6 }}\r\n                />\r\n                <Skeleton animation=\"wave\" height={10} width=\"80%\" />\r\n              </React.Fragment>\r\n            ) : (\r\n              <Typography\r\n                className={classes.description}\r\n                variant=\"body2\"\r\n                color=\"textSecondary\"\r\n                component=\"p\"\r\n              >\r\n                {previewData.description}\r\n              </Typography>\r\n            )}\r\n          </CardContent>\r\n        </CardActionArea>\r\n      </a>\r\n    </Card>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}